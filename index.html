<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Семейный Бюджет</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: #1e293b;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
        }

        header {
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: white;
            width: 36px;
            height: 36px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7c3aed;
            font-size: 18px;
        }

        nav {
            display: flex;
            gap: 8px;
        }

        .nav-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 8px;
            transition: all 0.2s;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .nav-button.active {
            background: rgba(255, 255, 255, 0.3);
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        main {
            padding: 24px 0;
        }

        .grid {
            display: grid;
            gap: 24px;
        }

        .grid-cols-1 {
            grid-template-columns: 1fr;
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 24px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            transform: translateY(-2px);
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .justify-center {
            justify-content: center;
        }

        .space-x-2 > * + * {
            margin-left: 8px;
        }

        .space-x-3 > * + * {
            margin-left: 12px;
        }

        .space-x-4 > * + * {
            margin-left: 16px;
        }

        .space-y-2 > * + * {
            margin-top: 8px;
        }

        .space-y-3 > * + * {
            margin-top: 12px;
        }

        .space-y-4 > * + * {
            margin-top: 16px;
        }

        .space-y-6 > * + * {
            margin-top: 24px;
        }

        .text-gray-600 {
            color: #71717a;
        }

        .text-green-600 {
            color: #16a34a;
        }

        .text-red-600 {
            color: #dc2626;
        }

        .text-blue-500 {
            color: #3b82f6;
        }

        .text-purple-500 {
            color: #a855f7;
        }

        .text-orange-600 {
            color: #ea580c;
        }

        .text-yellow-500 {
            color: #eab308;
        }

        .text-gray-500 {
            color: #a1a1aa;
        }

        .text-gray-400 {
            color: #d4d4d8;
        }

        .text-gray-700 {
            color: #52525b;
        }

        .text-gray-800 {
            color: #27272a;
        }

        .text-white {
            color: white;
        }

        .bg-white {
            background: white;
        }

        .bg-purple-600 {
            background: #7c3aed;
        }

        .bg-purple-100 {
            background: #f3e8ff;
        }

        .bg-green-100 {
            background: #dcfce7;
        }

        .bg-red-100 {
            background: #fee2e2;
        }

        .bg-blue-100 {
            background: #dbeafe;
        }

        .bg-yellow-100 {
            background: #fef9c3;
        }

        .bg-gray-50 {
            background: #fafafa;
        }

        .bg-gray-100 {
            background: #f4f4f5;
        }

        .bg-gray-200 {
            background: #e4e4e7;
        }

        .bg-purple-50 {
            background: #f5f3ff;
        }

        .bg-gray-300 {
            background: #cbd5e1;
        }

        .rounded {
            border-radius: 6px;
        }

        .rounded-lg {
            border-radius: 8px;
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .rounded-xl {
            border-radius: 12px;
        }

        .p-2 {
            padding: 8px;
        }

        .p-3 {
            padding: 12px;
        }

        .p-4 {
            padding: 16px;
        }

        .p-6 {
            padding: 24px;
        }

        .px-3 {
            padding-left: 12px;
            padding-right: 12px;
        }

        .px-4 {
            padding-left: 16px;
            padding-right: 16px;
        }

        .px-6 {
            padding-left: 24px;
            padding-right: 24px;
        }

        .py-2 {
            padding-top: 8px;
            padding-bottom: 8px;
        }

        .py-3 {
            padding-top: 12px;
            padding-bottom: 12px;
        }

        .py-4 {
            padding-top: 16px;
            padding-bottom: 16px;
        }

        .mb-2 {
            margin-bottom: 8px;
        }

        .mb-3 {
            margin-bottom: 12px;
        }

        .mb-4 {
            margin-bottom: 16px;
        }

        .mb-6 {
            margin-bottom: 24px;
        }

        .mt-2 {
            margin-top: 8px;
        }

        .mt-3 {
            margin-top: 12px;
        }

        .mt-4 {
            margin-top: 16px;
        }

        .ml-2 {
            margin-left: 8px;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-medium {
            font-weight: 500;
        }

        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .text-base {
            font-size: 1rem;
            line-height: 1.5rem;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }

        .w-full {
            width: 100%;
        }

        .h-2 {
            height: 0.5rem;
        }

        .h-3 {
            height: 0.75rem;
        }

        .h-4 {
            height: 1rem;
        }

        .w-3 {
            width: 0.75rem;
        }

        .w-4 {
            width: 1rem;
        }

        .border {
            border: 1px solid;
        }

        .border-b {
            border-bottom: 1px solid;
        }

        .border-gray-100 {
            border-color: #f1f5f9;
        }

        .border-gray-200 {
            border-color: #e2e8f0;
        }

        .border-gray-300 {
            border-color: #cbd5e1;
        }

        .border-transparent {
            border-color: transparent;
        }

        .border-green-500 {
            border-color: #16a34a;
        }

        .border-red-500 {
            border-color: #dc2626;
        }

        .cursor-pointer {
            cursor: pointer;
        }

        .transition-all {
            transition-property: all;
            transition-duration: 0.2s;
        }

        .transition-colors {
            transition-property: background-color, border-color, color;
            transition-duration: 0.2s;
        }

        .shadow-sm {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .shadow {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .z-10 {
            z-index: 10;
        }

        .z-50 {
            z-index: 50;
        }

        .sticky {
            position: sticky;
        }

        .top-0 {
            top: 0;
        }

        .overflow-x-auto {
            overflow-x: auto;
        }

        .overflow-y-auto {
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .line-through {
            text-decoration: line-through;
        }

        input, select, textarea {
            font-family: inherit;
            font-size: 0.875rem;
            line-height: 1.25rem;
            margin: 0;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            padding: 8px 12px;
            transition: all 0.2s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        button {
            cursor: pointer;
            border: none;
            background: none;
            font-family: inherit;
            font-size: 0.875rem;
            line-height: 1.25rem;
            margin: 0;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            color: white;
            border-radius: 6px;
            padding: 8px 16px;
            font-weight: 500;
            transition: background-color 0.2s;
            border: none;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.2);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #6d28d9 0%, #4338ca 100%);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border-radius: 6px;
            padding: 8px 16px;
            font-weight: 500;
            transition: background-color 0.2s;
            border: none;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        /* Calendar styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-header-cell {
            background-color: #f8fafc;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.875rem;
            color: #64748b;
        }

        .calendar-day-cell {
            background-color: white;
            min-height: 100px;
            padding: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            border: 1px solid #f1f5f9;
        }

        .calendar-day-cell:hover {
            background-color: #f8f9ff;
        }

        .calendar-day-cell.other-month {
            background-color: #f8fafc;
            color: #94a3b8;
        }

        .calendar-day-number {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .calendar-events-container {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .calendar-event-item {
            font-size: 0.75rem;
            padding: 2px 4px;
            border-radius: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: white;
            font-weight: 500;
        }

        .calendar-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
        }

        .calendar-nav-button {
            background-color: #f1f5f9;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .calendar-nav-button:hover {
            background-color: #e2e8f0;
        }

        .calendar-today-button {
            background-color: #7c3aed;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: background-color 0.2s;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.2);
        }

        .calendar-today-button:hover {
            background-color: #6d28d9;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            transform: translateY(-1px);
        }

        .selected-day {
            background-color: #e0e7ff !important;
            border: 2px solid #4f46e5;
        }

        /* Color picker */
        .color-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected {
            border-color: #000;
            transform: scale(1.1);
        }

        /* Categories */
        .categories-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .category-item {
            padding: 6px 12px;
            background: #f1f5f9;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .category-item.active {
            background: #7c3aed;
            color: white;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.2);
        }

        .category-item:hover:not(.active) {
            background: #e2e8f0;
        }

        /* Auth Page Styles */
        .auth-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            padding: 16px;
            position: relative;
            overflow: hidden;
        }

        .auth-page::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .auth-container {
            width: 100%;
            max-width: 480px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            position: relative;
            z-index: 2;
            backdrop-filter: blur(10px);
        }

        .auth-header {
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            padding: 40px 32px;
            text-align: center;
            color: white;
            position: relative;
        }

        .auth-header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .auth-header h1 {
            font-size: 2.25rem;
            font-weight: 800;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .auth-header p {
            font-size: 1.125rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .auth-form {
            padding: 48px 32px 32px;
        }

        .form-group {
            margin-bottom: 24px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.2s;
            background: #f9fafb;
        }

        .form-input:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
            background: white;
        }

        .form-input.error {
            border-color: #ef4444;
        }

        .btn-auth {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn-auth:hover {
            background: linear-gradient(135deg, #6d28d9 0%, #4338ca 100%);
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4);
            transform: translateY(-2px);
        }

        .btn-auth:active {
            transform: translateY(0);
        }

        .btn-auth.secondary {
            background: #f3f4f6;
            color: #4b5563;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-auth.secondary:hover {
            background: #e5e7eb;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .mode-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 12px;
            padding: 6px;
            margin-bottom: 32px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
            position: relative;
        }

        .mode-toggle-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 1;
        }

        .mode-toggle-btn.active {
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .mode-toggle-slider {
            position: absolute;
            top: 6px;
            left: 6px;
            height: calc(100% - 12px);
            width: calc(50% - 6px);
            background: linear-gradient(135deg, #7c3aed 0%, #4f46e5 100%);
            border-radius: 10px;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }

        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .success-message {
            color: #16a34a;
            font-size: 0.875rem;
            margin-top: 8px;
            text-align: center;
            padding: 16px;
            background: #dcfce7;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 500;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #7c3aed;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .auth-features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 32px;
            padding: 0 20px;
        }

        .feature-item {
            text-align: center;
            color: white;
            opacity: 0.9;
        }

        .feature-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .feature-text {
            font-size: 0.8rem;
            font-weight: 300;
        }

        /* Collapsible */
        .collapsible-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .collapsible-content {
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        .collapsible-content.expanded {
            max-height: 1000px;
        }

        /* Table alignment fix */
        .table-cell {
            text-align: left;
            padding: 12px 16px;
        }

        .table-header {
            text-align: left;
            padding: 12px 16px;
            font-weight: 600;
            color: #374151;
        }

        /* Placeholder text */
        .placeholder-text {
            color: #9ca3af;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .app-container {
                padding: 0 12px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 16px;
                padding: 16px 0;
            }
            
            .logo {
                font-size: 1.25rem;
            }
            
            nav {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
                gap: 6px;
            }
            
            .nav-button {
                padding: 8px 12px;
                font-size: 0.875rem;
            }
            
            main {
                padding: 16px 0;
            }
            
            .card {
                padding: 16px;
                border-radius: 12px;
            }
            
            .grid {
                gap: 16px;
            }
            
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .grid-cols-3 {
                grid-template-columns: 1fr;
            }
            
            .grid-cols-4 {
                grid-template-columns: 1fr;
            }
            
            .calendar-day-cell {
                min-height: 80px;
                padding: 6px;
            }
            
            .calendar-header-cell {
                padding: 8px 4px;
                font-size: 0.75rem;
            }
            
            /* Auth mobile styles */
            .auth-container {
                max-width: 100%;
                border-radius: 16px;
            }
            
            .auth-header {
                padding: 32px 24px;
            }
            
            .auth-header h1 {
                font-size: 1.75rem;
            }
            
            .auth-form {
                padding: 40px 24px 24px;
            }
            
            .mode-toggle {
                margin-bottom: 24px;
            }
            
            .auth-features {
                gap: 12px;
                padding: 0 12px;
            }
            
            .feature-icon {
                font-size: 1.25rem;
            }
            
            .feature-text {
                font-size: 0.7rem;
            }
        }

        @media (max-width: 480px) {
            .app-container {
                padding: 0 8px;
            }
            
            .header-content {
                padding: 12px 0;
            }
            
            nav {
                gap: 4px;
            }
            
            .nav-button {
                padding: 6px 10px;
                font-size: 0.75rem;
            }
            
            .card {
                padding: 12px;
            }
            
            .calendar-day-cell {
                min-height: 60px;
                padding: 4px;
            }
            
            .calendar-event-item {
                font-size: 0.625rem;
                padding: 1px 2px;
            }
            
            /* Auth mobile small styles */
            .auth-header {
                padding: 28px 20px;
            }
            
            .auth-header h1 {
                font-size: 1.5rem;
            }
            
            .auth-form {
                padding: 32px 20px 20px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            .auth-features {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
        }

        /* Modal overlay */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Initialize Firebase
        const firebaseConfig = {
            databaseURL: "https://budg-1d5e0-default-rtdb.europe-west1.firebasedatabase.app"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        const database = firebase.database();

        const FamilyBudgetApp = () => {
            const [activeTab, setActiveTab] = useState('budget');
            const [currentRoom, setCurrentRoom] = useState(null);
            const [showRoomModal, setShowRoomModal] = useState(true);
            const [roomMode, setRoomMode] = useState('join');
            const [roomNameInput, setRoomNameInput] = useState(''); // Для входа используем название
            const [roomName, setRoomName] = useState(''); // Для создания используем название
            const [roomPassword, setRoomPassword] = useState('');
            const [roomError, setRoomError] = useState('');
            const [roomSuccess, setRoomSuccess] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            // Budget states
            const [transactions, setTransactions] = useState([
                { id: 1, type: 'income', amount: 50000, category: 'Зарплата', date: '2024-01-15', description: 'Зарплата Ивана', balanceAfter: 50000 },
                { id: 2, type: 'expense', amount: 15000, category: 'Продукты', date: '2024-01-16', description: 'Покупка продуктов', balanceAfter: 35000 },
                { id: 3, type: 'expense', amount: 8000, category: 'Транспорт', date: '2024-01-17', description: 'Бензин', balanceAfter: 27000 },
                { id: 4, type: 'expense', amount: 5000, category: 'Продукты', date: '2024-01-18', description: 'Овощи и фрукты', balanceAfter: 22000 },
                { id: 5, type: 'expense', amount: 3000, category: 'Развлечения', date: '2024-01-19', description: 'Кино', balanceAfter: 19000 }
            ]);
            
            const [initialBalance, setInitialBalance] = useState(0);
            const [newTransaction, setNewTransaction] = useState({
                type: 'expense',
                amount: '',
                category: 'Продукты',
                date: new Date().toISOString().split('T')[0],
                description: ''
            });
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedDate, setSelectedDate] = useState(null);
            const [showAddTransaction, setShowAddTransaction] = useState(false);
            const [showAllTime, setShowAllTime] = useState(false);
            
            // Shopping list states
            const [shoppingList, setShoppingList] = useState([
                { id: 1, item: 'Молоко', quantity: 1, unit: 'литр', completed: false },
                { id: 2, item: 'Хлеб', quantity: 2, unit: 'штука', completed: true },
                { id: 3, item: 'Яблоки', quantity: 3, unit: 'килограмм', completed: false }
            ]);
            
            const [newItem, setNewItem] = useState({ name: '', quantity: 1, unit: 'штука' });
            
            // Calendar states
            const [calendarEvents, setCalendarEvents] = useState([
                { id: 1, title: 'Оплата кредита', date: '2024-01-20', color: 'bg-blue-500' },
                { id: 2, title: 'Покупка подарка', date: '2024-01-25', color: 'bg-pink-500' }
            ]);
            
            const [newEvent, setNewEvent] = useState({
                title: '',
                date: new Date().toISOString().split('T')[0],
                color: 'bg-blue-500'
            });
            
            const [currentDate, setCurrentDate] = useState(new Date());
            const [calendarView, setCalendarView] = useState('month');
            
            // Settings
            const [fixedExpenses, setFixedExpenses] = useState([
                { id: 1, name: 'Аренда', amount: 15000, category: 'Жилье' },
                { id: 2, name: 'Кредит', amount: 8000, category: 'Жилье' }
            ]);
            
            const [savingsPercentage, setSavingsPercentage] = useState(20);
            const [authorNames] = useState(['Иван', 'Мария']);
            const [showSettings, setShowSettings] = useState(false);
            
            // Categories
            const [selectedCategory, setSelectedCategory] = useState('all');
            const [categories, setCategories] = useState(['Продукты', 'Транспорт', 'Жилье', 'Развлечения', 'Здоровье', 'Образование', 'Зарплата', 'Фриланс']);
            
            // Color options for events
            const colorOptions = [
                'bg-blue-500', 'bg-pink-500', 'bg-green-500', 'bg-yellow-500', 
                'bg-purple-500', 'bg-red-500', 'bg-indigo-500', 'bg-teal-500'
            ];

            // Load room data from Firebase
            const loadRoomData = async (roomName, password) => {
                try {
                    setIsLoading(true);
                    
                    // Получаем список всех комнат
                    const roomsRef = database.ref('rooms');
                    const snapshot = await roomsRef.once('value');
                    const roomsData = snapshot.val();
                    
                    if (!roomsData) {
                        throw new Error('Комнаты не найдены');
                    }
                    
                    // Ищем комнату по названию
                    let foundRoomKey = null;
                    let foundRoomData = null;
                    
                    for (const [key, room] of Object.entries(roomsData)) {
                        if (room.name === roomName) {
                            foundRoomKey = key;
                            foundRoomData = room;
                            break;
                        }
                    }
                    
                    if (!foundRoomKey || !foundRoomData) {
                        throw new Error('Комната не найдена');
                    }
                    
                    if (foundRoomData.password !== password) {
                        throw new Error('Неверный пароль');
                    }
                    
                    // Load data
                    setTransactions(foundRoomData.transactions || []);
                    setShoppingList(foundRoomData.shoppingList || []);
                    setCalendarEvents(foundRoomData.calendarEvents || []);
                    setFixedExpenses(foundRoomData.fixedExpenses || []);
                    setInitialBalance(foundRoomData.initialBalance || 0);
                    setSavingsPercentage(foundRoomData.savingsPercentage || 20);
                    setCategories(foundRoomData.categories || ['Продукты', 'Транспорт', 'Жилье', 'Развлечения', 'Здоровье', 'Образование', 'Зарплата', 'Фриланс']);
                    
                    return { key: foundRoomKey, data: foundRoomData };
                } catch (error) {
                    console.error('Error loading room data:', error);
                    throw error;
                } finally {
                    setIsLoading(false);
                }
            };

            // Save room data to Firebase
            const saveRoomData = async (roomKey, roomName, password) => {
                try {
                    const roomData = {
                        name: roomName,
                        password: password,
                        transactions: transactions,
                        shoppingList: shoppingList,
                        calendarEvents: calendarEvents,
                        fixedExpenses: fixedExpenses,
                        initialBalance: initialBalance,
                        savingsPercentage: savingsPercentage,
                        categories: categories,
                        lastUpdated: firebase.database.ServerValue.TIMESTAMP
                    };
                    
                    await database.ref(`rooms/${roomKey}`).set(roomData);
                } catch (error) {
                    console.error('Error saving room data:', error);
                    throw error;
                }
            };

            // Create new room
            const createNewRoom = async (roomName, password) => {
                try {
                    // Проверяем, существует ли уже комната с таким названием
                    const roomsRef = database.ref('rooms');
                    const snapshot = await roomsRef.once('value');
                    const roomsData = snapshot.val();
                    
                    if (roomsData) {
                        for (const [key, room] of Object.entries(roomsData)) {
                            if (room.name === roomName) {
                                throw new Error('Комната с таким названием уже существует');
                            }
                        }
                    }
                    
                    // Генерируем уникальный ключ для комнаты
                    const newRoomKey = 'room_' + Date.now();
                    
                    // Initialize room with default data
                    const defaultTransactions = [
                        { id: 1, type: 'income', amount: 50000, category: 'Зарплата', date: '2024-01-15', description: 'Зарплата Ивана', balanceAfter: 50000 },
                        { id: 2, type: 'expense', amount: 15000, category: 'Продукты', date: '2024-01-16', description: 'Покупка продуктов', balanceAfter: 35000 },
                        { id: 3, type: 'expense', amount: 8000, category: 'Транспорт', date: '2024-01-17', description: 'Бензин', balanceAfter: 27000 },
                        { id: 4, type: 'expense', amount: 5000, category: 'Продукты', date: '2024-01-18', description: 'Овощи и фрукты', balanceAfter: 22000 },
                        { id: 5, type: 'expense', amount: 3000, category: 'Развлечения', date: '2024-01-19', description: 'Кино', balanceAfter: 19000 }
                    ];
                    
                    const defaultShoppingList = [
                        { id: 1, item: 'Молоко', quantity: 1, unit: 'литр', completed: false },
                        { id: 2, item: 'Хлеб', quantity: 2, unit: 'штука', completed: true },
                        { id: 3, item: 'Яблоки', quantity: 3, unit: 'килограмм', completed: false }
                    ];
                    
                    const defaultCalendarEvents = [
                        { id: 1, title: 'Оплата кредита', date: '2024-01-20', color: 'bg-blue-500' },
                        { id: 2, title: 'Покупка подарка', date: '2024-01-25', color: 'bg-pink-500' }
                    ];
                    
                    const defaultCategories = ['Продукты', 'Транспорт', 'Жилье', 'Развлечения', 'Здоровье', 'Образование', 'Зарплата', 'Фриланс'];
                    
                    // Set default data locally
                    setTransactions(defaultTransactions);
                    setShoppingList(defaultShoppingList);
                    setCalendarEvents(defaultCalendarEvents);
                    setFixedExpenses([]);
                    setInitialBalance(0);
                    setSavingsPercentage(20);
                    setCategories(defaultCategories);
                    
                    // Save to Firebase
                    const roomData = {
                        name: roomName,
                        password: password,
                        transactions: defaultTransactions,
                        shoppingList: defaultShoppingList,
                        calendarEvents: defaultCalendarEvents,
                        fixedExpenses: [],
                        initialBalance: 0,
                        savingsPercentage: 20,
                        categories: defaultCategories,
                        lastUpdated: firebase.database.ServerValue.TIMESTAMP
                    };
                    
                    await database.ref(`rooms/${newRoomKey}`).set(roomData);
                    
                    return newRoomKey;
                } catch (error) {
                    console.error('Error creating room:', error);
                    throw error;
                }
            };

            // Handle room form changes
            const handleRoomChange = (field, value) => {
                if (field === 'roomNameInput') setRoomNameInput(value);
                if (field === 'roomName') setRoomName(value);
                if (field === 'roomPassword') setRoomPassword(value);
                setRoomError('');
            };

            // Join room
            const joinRoom = async (e) => {
                e.preventDefault();
                setRoomError('');
                setRoomSuccess('');
                
                // Simple validation
                if (!roomNameInput.trim()) {
                    setRoomError('Пожалуйста, введите название комнаты');
                    return;
                }
                
                if (!roomPassword.trim()) {
                    setRoomError('Пожалуйста, введите пароль комнаты');
                    return;
                }
                
                try {
                    setIsLoading(true);
                    const roomResult = await loadRoomData(roomNameInput, roomPassword);
                    setCurrentRoom({ 
                        id: roomResult.key, 
                        name: roomResult.data.name, 
                        password: roomPassword 
                    });
                    setShowRoomModal(false);
                    setRoomSuccess('Успешный вход в комнату!');
                    setTimeout(() => setRoomSuccess(''), 2000);
                } catch (error) {
                    setRoomError(error.message || 'Ошибка при входе в комнату');
                } finally {
                    setIsLoading(false);
                }
            };

            // Create room
            const createRoom = async (e) => {
                e.preventDefault();
                setRoomError('');
                setRoomSuccess('');
                
                // Simple validation
                if (!roomName.trim()) {
                    setRoomError('Пожалуйста, введите название комнаты');
                    return;
                }
                
                if (!roomPassword.trim()) {
                    setRoomError('Пожалуйста, введите пароль для комнаты');
                    return;
                }
                
                try {
                    setIsLoading(true);
                    const newRoomKey = await createNewRoom(roomName, roomPassword);
                    setCurrentRoom({ 
                        id: newRoomKey, 
                        name: roomName, 
                        password: roomPassword 
                    });
                    setShowRoomModal(false);
                    setRoomSuccess('Комната успешно создана!');
                    setTimeout(() => setRoomSuccess(''), 2000);
                } catch (error) {
                    setRoomError(error.message || 'Ошибка при создании комнаты');
                } finally {
                    setIsLoading(false);
                }
            };

            // Exit room
            const exitRoom = () => {
                setCurrentRoom(null);
                setShowRoomModal(true);
                setRoomNameInput('');
                setRoomName('');
                setRoomPassword('');
                // Clear local data
                setTransactions([]);
                setShoppingList([]);
                setCalendarEvents([]);
                setFixedExpenses([]);
                setInitialBalance(0);
                setSavingsPercentage(20);
                setCategories(['Продукты', 'Транспорт', 'Жилье', 'Развлечения', 'Здоровье', 'Образование', 'Зарплата', 'Фриланс']);
            };

            // Save data when it changes
            useEffect(() => {
                if (currentRoom) {
                    const saveTimer = setTimeout(() => {
                        saveRoomData(currentRoom.id, currentRoom.name, currentRoom.password);
                    }, 1000);
                    
                    return () => clearTimeout(saveTimer);
                }
            }, [transactions, shoppingList, calendarEvents, fixedExpenses, initialBalance, savingsPercentage, categories, currentRoom]);

            // Calculate financial metrics
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const totalExpenses = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const fixedExpensesTotal = fixedExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            const balance = initialBalance + totalIncome - totalExpenses;
            const availableToSave = balance > 0 ? balance * (savingsPercentage / 100) : 0;
            const dailySpendingLimit = Math.max(0, (balance - availableToSave - fixedExpensesTotal) / 30);

            // Add transaction
            const addTransaction = () => {
                if (newTransaction.amount && newTransaction.description) {
                    const transaction = {
                        id: Date.now(),
                        ...newTransaction,
                        amount: parseFloat(newTransaction.amount),
                        balanceAfter: calculateBalanceAfterNewTransaction()
                    };
                    setTransactions([...transactions, transaction]);
                    
                    // Add category to categories list if it doesn't exist
                    if (!categories.includes(newTransaction.category)) {
                        setCategories([...categories, newTransaction.category]);
                    }
                    
                    setNewTransaction({
                        type: 'expense',
                        amount: '',
                        category: 'Продукты',
                        date: new Date().toISOString().split('T')[0],
                        description: ''
                    });
                }
            };

            const calculateBalanceAfterNewTransaction = () => {
                const lastBalance = transactions.length > 0 ? transactions[transactions.length - 1].balanceAfter : initialBalance;
                const amount = parseFloat(newTransaction.amount) || 0;
                return newTransaction.type === 'income' ? lastBalance + amount : lastBalance - amount;
            };

            // Add shopping item
            const addShoppingItem = () => {
                if (newItem.name.trim()) {
                    const item = {
                        id: Date.now(),
                        ...newItem,
                        completed: false
                    };
                    setShoppingList([...shoppingList, item]);
                    setNewItem({ name: '', quantity: 1, unit: 'штука' });
                }
            };

            // Toggle shopping item
            const toggleShoppingItem = (id) => {
                setShoppingList(shoppingList.map(item => 
                    item.id === id ? { ...item, completed: !item.completed } : item
                ));
            };

            // Delete shopping item
            const deleteShoppingItem = (id) => {
                setShoppingList(shoppingList.filter(item => item.id !== id));
            };

            // Add calendar event
            const addCalendarEvent = () => {
                if (newEvent.title) {
                    const event = {
                        id: Date.now(),
                        ...newEvent
                    };
                    setCalendarEvents([...calendarEvents, event]);
                    setNewEvent({
                        title: '',
                        date: new Date().toISOString().split('T')[0],
                        color: 'bg-blue-500'
                    });
                }
            };

            // Delete calendar event
            const deleteCalendarEvent = (id) => {
                setCalendarEvents(calendarEvents.filter(event => event.id !== id));
            };

            // Calendar navigation
            const navigateCalendar = (direction) => {
                const newDate = new Date(currentDate);
                if (calendarView === 'month') {
                    newDate.setMonth(newDate.getMonth() + direction);
                } else {
                    newDate.setDate(newDate.getDate() + (direction * 7));
                }
                setCurrentDate(newDate);
            };

            // Get calendar data
            const getCalendarData = () => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());
                
                const endDate = new Date(lastDay);
                endDate.setDate(endDate.getDate() + (6 - lastDay.getDay()));
                
                const days = [];
                const currentDateIter = new Date(startDate);
                
                while (currentDateIter <= endDate) {
                    days.push(new Date(currentDateIter));
                    currentDateIter.setDate(currentDateIter.getDate() + 1);
                }
                
                return { days, title: currentDate.toLocaleString('ru-RU', { month: 'long', year: 'numeric' }) };
            };

            const { days, title } = getCalendarData();

            // Get events for specific date
            const getEventsForDate = (date) => {
                return calendarEvents.filter(event => 
                    new Date(event.date).toDateString() === date.toDateString()
                );
            };

            // Handle day click in calendar
            const handleDayClick = (day) => {
                // If clicking the same date again, deselect it (reset filter)
                if (selectedDate && day.toDateString() === selectedDate.toDateString()) {
                    setSelectedDate(null);
                    setShowAllTime(false);
                } else {
                    setSelectedDate(day);
                    setShowAllTime(false);
                }
            };

            // Filtered transactions
            const filteredTransactions = transactions.filter(transaction => {
                // Filter by search term
                if (searchTerm && !(
                    transaction.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    transaction.category.toLowerCase().includes(searchTerm.toLowerCase())
                )) {
                    return false;
                }
                
                // Filter by selected category
                if (selectedCategory !== 'all' && transaction.category !== selectedCategory) {
                    return false;
                }
                
                // Filter by selected date or show all time
                if (!showAllTime) {
                    if (selectedDate) {
                        // Show transactions for selected date
                        if (new Date(transaction.date).toDateString() !== selectedDate.toDateString()) {
                            return false;
                        }
                    } else {
                        // Show transactions for current month
                        const transactionDate = new Date(transaction.date);
                        const currentMonth = currentDate.getMonth();
                        const currentYear = currentDate.getFullYear();
                        if (transactionDate.getMonth() !== currentMonth || transactionDate.getFullYear() !== currentYear) {
                            return false;
                        }
                    }
                }
                
                return true;
            });

            // Get categories for selected date
            const getCategoriesForSelectedDate = () => {
                if (!selectedDate) return categories;
                
                const dateTransactions = transactions.filter(t => 
                    new Date(t.date).toDateString() === selectedDate.toDateString()
                );
                
                const uniqueCategories = [...new Set(dateTransactions.map(t => t.category))];
                return uniqueCategories.length > 0 ? uniqueCategories : categories;
            };

            const dateCategories = getCategoriesForSelectedDate();

            // Close modal without action
            const closeRoomModal = () => {
                setShowRoomModal(false);
            };

            // Render room modal
            const renderRoomModal = () => {
                if (!showRoomModal) return null;
                
                return React.createElement('div', { className: 'modal-overlay' },
                    React.createElement('div', { className: 'auth-container' },
                        React.createElement('div', { className: 'auth-header' },
                            React.createElement('h1', null, 'Семейный Бюджет'),
                            React.createElement('p', null, 'Управляйте своими финансами эффективно')
                        ),
                        
                        React.createElement('div', { className: 'auth-form' },
                            roomSuccess && React.createElement('div', { className: 'success-message' },
                                React.createElement('i', { className: 'fas fa-check-circle' }),
                                roomSuccess
                            ),
                            
                            React.createElement('div', { className: 'mode-toggle', style: { position: 'relative' } },
                                React.createElement('div', 
                                    {
                                        className: 'mode-toggle-slider',
                                        style: { 
                                            left: roomMode === 'join' ? '6px' : 'calc(50% + 3px)',
                                            width: 'calc(50% - 9px)'
                                        }
                                    }
                                ),
                                React.createElement('div', 
                                    {
                                        className: 'mode-toggle-btn ' + (roomMode === 'join' ? 'active' : ''),
                                        onClick: () => {
                                            setRoomMode('join');
                                            setRoomError('');
                                        },
                                        style: { zIndex: 2 }
                                    },
                                    'Войти'
                                ),
                                React.createElement('div', 
                                    {
                                        className: 'mode-toggle-btn ' + (roomMode === 'create' ? 'active' : ''),
                                        onClick: () => {
                                            setRoomMode('create');
                                            setRoomError('');
                                        },
                                        style: { zIndex: 2 }
                                    },
                                    'Создать'
                                )
                            ),
                            
                            isLoading && React.createElement('div', { className: 'loading' },
                                React.createElement('div', { className: 'spinner' }),
                                React.createElement('span', null, 'Загрузка...')
                            ),
                            
                            !isLoading && roomMode === 'join' ? 
                            React.createElement('form', { onSubmit: joinRoom },
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', { className: 'form-label' }, 'Название комнаты'),
                                    React.createElement('input',
                                        {
                                            type: 'text',
                                            className: 'form-input ' + (roomError && !roomNameInput ? 'error' : ''),
                                            value: roomNameInput,
                                            onChange: (e) => handleRoomChange('roomNameInput', e.target.value),
                                            placeholder: 'Введите название комнаты'
                                        }
                                    )
                                ),
                                
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', { className: 'form-label' }, 'Пароль комнаты'),
                                    React.createElement('input',
                                        {
                                            type: 'password',
                                            className: 'form-input ' + (roomError && !roomPassword ? 'error' : ''),
                                            value: roomPassword,
                                            onChange: (e) => handleRoomChange('roomPassword', e.target.value),
                                            placeholder: 'Введите пароль комнаты'
                                        }
                                    )
                                ),
                                
                                roomError && React.createElement('div', { className: 'error-message' },
                                    React.createElement('i', { className: 'fas fa-exclamation-circle' }),
                                    roomError
                                ),
                                
                                React.createElement('button', { type: 'submit', className: 'btn-auth' }, 'Войти в комнату')
                            ) :
                            React.createElement('form', { onSubmit: createRoom },
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', { className: 'form-label' }, 'Название комнаты'),
                                    React.createElement('input',
                                        {
                                            type: 'text',
                                            className: 'form-input ' + (roomError && !roomName ? 'error' : ''),
                                            value: roomName,
                                            onChange: (e) => handleRoomChange('roomName', e.target.value),
                                            placeholder: 'Введите название комнаты'
                                        }
                                    )
                                ),
                                
                                React.createElement('div', { className: 'form-group' },
                                    React.createElement('label', { className: 'form-label' }, 'Пароль для комнаты'),
                                    React.createElement('input',
                                        {
                                            type: 'password',
                                            className: 'form-input ' + (roomError && !roomPassword ? 'error' : ''),
                                            value: roomPassword,
                                            onChange: (e) => handleRoomChange('roomPassword', e.target.value),
                                            placeholder: 'Введите пароль для комнаты'
                                        }
                                    )
                                ),
                                
                                roomError && React.createElement('div', { className: 'error-message' },
                                    React.createElement('i', { className: 'fas fa-exclamation-circle' }),
                                    roomError
                                ),
                                
                                React.createElement('button', { type: 'submit', className: 'btn-auth' }, 'Создать комнату')
                            ),
                            
                            React.createElement('div', { className: 'auth-features' },
                                React.createElement('div', { className: 'feature-item' },
                                    React.createElement('div', { className: 'feature-icon' },
                                        React.createElement('i', { className: 'fas fa-users' })
                                    ),
                                    React.createElement('div', { className: 'feature-text' }, 'Совместное использование')
                                ),
                                React.createElement('div', { className: 'feature-item' },
                                    React.createElement('div', { className: 'feature-icon' },
                                        React.createElement('i', { className: 'fas fa-sync' })
                                    ),
                                    React.createElement('div', { className: 'feature-text' }, 'Автосинхронизация')
                                ),
                                React.createElement('div', { className: 'feature-item' },
                                    React.createElement('div', { className: 'feature-icon' },
                                        React.createElement('i', { className: 'fas fa-shield-alt' })
                                    ),
                                    React.createElement('div', { className: 'feature-text' }, 'Защита данных')
                                )
                            )
                        )
                    )
                );
            };

            // Render settings
            const renderSettings = () => {
                return React.createElement('div', { className: 'card' },
                    React.createElement('div', 
                        {
                            className: 'collapsible-header',
                            onClick: () => setShowSettings(!showSettings)
                        },
                        React.createElement('h2', { className: 'text-lg font-semibold' }, 'Настройки'),
                        React.createElement('i', { 
                            className: 'fas ' + (showSettings ? 'fa-chevron-up' : 'fa-chevron-down') 
                        })
                    ),
                    
                    React.createElement('div', { 
                        className: 'collapsible-content ' + (showSettings ? 'expanded' : 'collapsed')
                    },
                        React.createElement('div', { className: 'space-y-6' },
                            // Room info and exit button
                            currentRoom && React.createElement('div', { className: 'flex items-center justify-between p-4 bg-gray-50 rounded-lg' },
                                React.createElement('div', null,
                                    React.createElement('h3', { className: 'font-medium' }, 'Название комнаты'),
                                    React.createElement('p', { className: 'text-gray-600' }, currentRoom.name)
                                ),
                                React.createElement('button',
                                    {
                                        onClick: exitRoom,
                                        className: 'btn-primary'
                                    },
                                    'Выйти из комнаты'
                                )
                            ),
                            
                            // Initial balance
                            React.createElement('div', { className: 'mb-6' },
                                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' },
                                    'Начальный остаток'
                                ),
                                React.createElement('input',
                                    {
                                        type: 'number',
                                        value: initialBalance || '',
                                        onChange: (e) => setInitialBalance(parseFloat(e.target.value) || 0),
                                        placeholder: 'Введите начальный остаток',
                                        className: 'w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                    }
                                )
                            ),
                            
                            // Savings percentage
                            React.createElement('div', { className: 'mb-6' },
                                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' },
                                    'Процент для откладывания: ', savingsPercentage, '%'
                                ),
                                React.createElement('input',
                                    {
                                        type: 'range',
                                        min: '0',
                                        max: '50',
                                        value: savingsPercentage,
                                        onChange: (e) => setSavingsPercentage(parseInt(e.target.value)),
                                        className: 'w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-purple-600'
                                    }
                                )
                            ),
                            
                            // Fixed expenses
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('div', { className: 'flex justify-between items-center mb-4' },
                                    React.createElement('h3', { className: 'text-md font-semibold' }, 'Обязательные траты'),
                                    React.createElement('button',
                                        {
                                            onClick: () => {
                                                const newExpense = {
                                                    id: Date.now(),
                                                    name: 'Новая трата',
                                                    amount: 0,
                                                    category: 'Продукты'
                                                };
                                                setFixedExpenses([...fixedExpenses, newExpense]);
                                            },
                                            className: 'btn-primary'
                                        },
                                        'Добавить'
                                    )
                                ),
                                
                                React.createElement('div', { className: 'space-y-3' },
                                    fixedExpenses.map(expense => 
                                        React.createElement('div', { key: expense.id, className: 'flex items-center gap-3 p-3 border border-gray-200 rounded-lg' },
                                            React.createElement('input',
                                                {
                                                    type: 'text',
                                                    value: expense.name,
                                                    onChange: (e) => setFixedExpenses(fixedExpenses.map(f => 
                                                        f.id === expense.id ? {...f, name: e.target.value} : f
                                                    )),
                                                    placeholder: 'Название траты',
                                                    className: 'flex-1 px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent ' + (expense.name ? '' : 'placeholder-text')
                                                }
                                            ),
                                            React.createElement('input',
                                                {
                                                    type: 'number',
                                                    value: expense.amount || '',
                                                    onChange: (e) => setFixedExpenses(fixedExpenses.map(f => 
                                                        f.id === expense.id ? {...f, amount: parseFloat(e.target.value) || 0} : f
                                                    )),
                                                    placeholder: 'Сумма',
                                                    className: 'w-32 px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent ' + (expense.amount ? '' : 'placeholder-text')
                                                }
                                            ),
                                            React.createElement('select',
                                                {
                                                    value: expense.category,
                                                    onChange: (e) => setFixedExpenses(fixedExpenses.map(f => 
                                                        f.id === expense.id ? {...f, category: e.target.value} : f
                                                    )),
                                                    className: 'w-32 px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                                },
                                                React.createElement('option', { value: 'Продукты' }, 'Продукты'),
                                                React.createElement('option', { value: 'Жилье' }, 'Жилье'),
                                                React.createElement('option', { value: 'Транспорт' }, 'Транспорт'),
                                                React.createElement('option', { value: 'Коммуналка' }, 'Коммуналка'),
                                                React.createElement('option', { value: 'Кредит' }, 'Кредит'),
                                                React.createElement('option', { value: 'Страховка' }, 'Страховка')
                                            ),
                                            React.createElement('button',
                                                {
                                                    onClick: () => setFixedExpenses(fixedExpenses.filter(f => f.id !== expense.id)),
                                                    className: 'text-red-500 hover:text-red-700 p-2'
                                                },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                );
            };

            return React.createElement('div', { className: 'min-h-screen bg-gray-50' },
                // Room Modal
                renderRoomModal(),
                
                // Header
                React.createElement('header', null,
                    React.createElement('div', { className: 'app-container' },
                        React.createElement('div', { className: 'header-content' },
                            React.createElement('div', { className: 'flex items-center space-x-3' },
                                React.createElement('h1', { className: 'logo' },
                                    React.createElement('div', { className: 'logo-icon' },
                                        React.createElement('i', { className: 'fas fa-wallet' })
                                    ),
                                    'Семейный Бюджет'
                                )
                            ),
                            React.createElement('nav', { className: 'flex' },
                                [
                                    { id: 'budget', label: 'Бюджет', icon: 'fas fa-wallet' },
                                    { id: 'shopping', label: 'Покупки', icon: 'fas fa-shopping-cart' },
                                    { id: 'planner', label: 'Планировщик', icon: 'fas fa-calendar-alt' }
                                ].map(({ id, label, icon }) => 
                                    React.createElement('button',
                                        {
                                            key: id,
                                            onClick: () => setActiveTab(id),
                                            className: 'nav-button ' + (activeTab === id ? 'active' : '')
                                        },
                                        React.createElement('i', { className: icon }),
                                        React.createElement('span', { className: 'ml-2' }, label)
                                    )
                                )
                            )
                        )
                    )
                ),

                React.createElement('main', { className: 'app-container' },
                    // Budget Tab
                    activeTab === 'budget' && React.createElement('div', { className: 'space-y-6' },
                        // Financial Summary
                        React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-4 gap-4' },
                            React.createElement('div', { className: 'card' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('div', null,
                                        React.createElement('p', { className: 'text-gray-600 text-sm' }, 'Начальный остаток'),
                                        React.createElement('input',
                                            {
                                                type: 'number',
                                                value: initialBalance || '',
                                                onChange: (e) => setInitialBalance(parseFloat(e.target.value) || 0),
                                                placeholder: '0',
                                                className: 'text-xl font-bold text-purple-600 w-full bg-transparent border-b border-transparent hover:border-gray-300 focus:border-purple-500 focus:outline-none'
                                            }
                                        )
                                    ),
                                    React.createElement('div', { className: 'text-purple-500' }, '💰')
                                )
                            ),
                            
                            React.createElement('div', { className: 'card' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('div', null,
                                        React.createElement('p', { className: 'text-gray-600 text-sm' }, 'Текущий баланс'),
                                        React.createElement('p', { className: `text-xl font-bold ${balance >= 0 ? 'text-green-600' : 'text-red-600'}` },
                                            balance.toLocaleString('ru-RU'), ' ₽'
                                        )
                                    ),
                                    React.createElement('div', { className: 'text-blue-500' }, '💳')
                                )
                            ),
                            
                            React.createElement('div', { className: 'card' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('div', null,
                                        React.createElement('p', { className: 'text-gray-600 text-sm' }, 'Можно отложить'),
                                        React.createElement('p', { className: 'text-xl font-bold text-green-600' },
                                            availableToSave.toLocaleString('ru-RU'), ' ₽'
                                        )
                                    ),
                                    React.createElement('div', { className: 'text-green-500' }, '📈')
                                )
                            ),
                            
                            React.createElement('div', { className: 'card' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('div', null,
                                        React.createElement('p', { className: 'text-gray-600 text-sm' }, 'Ежедневно можно тратить'),
                                        React.createElement('p', { className: 'text-xl font-bold text-orange-600' },
                                            dailySpendingLimit.toLocaleString('ru-RU', { maximumFractionDigits: 0 }), ' ₽'
                                        )
                                    ),
                                    React.createElement('div', { className: 'text-orange-500' }, '📉')
                                )
                            )
                        ),

                        // Add Transaction
                        React.createElement('div', { className: 'card' },
                            React.createElement('button',
                                {
                                    onClick: () => setShowAddTransaction(!showAddTransaction),
                                    className: 'flex items-center justify-between w-full'
                                },
                                React.createElement('h2', { className: 'text-lg font-semibold' }, 'Добавить операцию'),
                                React.createElement('div', null, showAddTransaction ? '▲' : '▼')
                            ),
                            
                            showAddTransaction && React.createElement('div', { className: 'mt-4' },
                                React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-3' },
                                    React.createElement('select',
                                        {
                                            value: newTransaction.type,
                                            onChange: (e) => setNewTransaction({...newTransaction, type: e.target.value}),
                                            className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        },
                                        React.createElement('option', { value: 'income' }, 'Доход'),
                                        React.createElement('option', { value: 'expense' }, 'Расход')
                                    ),
                                    
                                    React.createElement('input',
                                        {
                                            type: 'number',
                                            placeholder: 'Сумма',
                                            value: newTransaction.amount,
                                            onChange: (e) => setNewTransaction({...newTransaction, amount: e.target.value}),
                                            className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    ),
                                    
                                    React.createElement('select',
                                        {
                                            value: newTransaction.category,
                                            onChange: (e) => setNewTransaction({...newTransaction, category: e.target.value}),
                                            className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        },
                                        categories.map(category => 
                                            React.createElement('option', { key: category, value: category }, category)
                                        )
                                    ),
                                    
                                    React.createElement('input',
                                        {
                                            type: 'date',
                                            value: newTransaction.date,
                                            onChange: (e) => setNewTransaction({...newTransaction, date: e.target.value}),
                                            className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    ),
                                    
                                    React.createElement('input',
                                        {
                                            type: 'text',
                                            placeholder: 'Описание',
                                            value: newTransaction.description,
                                            onChange: (e) => setNewTransaction({...newTransaction, description: e.target.value}),
                                            className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    ),
                                    
                                    React.createElement('button',
                                        {
                                            onClick: addTransaction,
                                            className: 'btn-primary flex items-center justify-center'
                                        },
                                        React.createElement('i', { className: 'fas fa-plus mr-2' }),
                                        'Добавить'
                                    )
                                )
                            )
                        ),

                        // Calendar
                        React.createElement('div', { className: 'card' },
                            React.createElement('div', { className: 'calendar-navigation' },
                                React.createElement('div', { className: 'flex items-center space-x-3' },
                                    React.createElement('button',
                                        {
                                            onClick: () => navigateCalendar(-1),
                                            className: 'calendar-nav-button'
                                        },
                                        React.createElement('i', { className: 'fas fa-chevron-left' })
                                    ),
                                    React.createElement('h2', { className: 'calendar-title' }, title),
                                    React.createElement('button',
                                        {
                                            onClick: () => navigateCalendar(1),
                                            className: 'calendar-nav-button'
                                        },
                                        React.createElement('i', { className: 'fas fa-chevron-right' })
                                    )
                                ),
                                React.createElement('button',
                                    {
                                        onClick: () => {
                                            const today = new Date();
                                            setCurrentDate(today);
                                            setSelectedDate(today);
                                        },
                                        className: 'calendar-today-button'
                                    },
                                    'Сегодня'
                                )
                            ),
                            
                            React.createElement('div', { className: 'calendar-grid' },
                                ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'].map(day => 
                                    React.createElement('div', { key: day, className: 'calendar-header-cell' }, day)
                                ),
                                
                                days.map((day, index) => {
                                    const isCurrentMonth = day.getMonth() === currentDate.getMonth();
                                    const isSelected = selectedDate && day.toDateString() === selectedDate.toDateString();
                                    const events = getEventsForDate(day);
                                    const dayTransactions = transactions.filter(t => 
                                        new Date(t.date).toDateString() === day.toDateString()
                                    );
                                    const hasEvents = events.length > 0 || dayTransactions.length > 0;
                                    
                                    return React.createElement('div',
                                        {
                                            key: index,
                                            className: `calendar-day-cell ${isCurrentMonth ? '' : 'other-month'} ${isSelected ? 'selected-day' : ''} ${hasEvents ? 'cursor-pointer' : ''}`,
                                            onClick: () => hasEvents && handleDayClick(day)
                                        },
                                        React.createElement('div', { className: 'calendar-day-number' },
                                            day.getDate()
                                        ),
                                        
                                        React.createElement('div', { className: 'calendar-events-container' },
                                            events.slice(0, 2).map(event => 
                                                React.createElement('div',
                                                    {
                                                        key: event.id,
                                                        className: `calendar-event-item ${event.color}`,
                                                        title: event.title
                                                    },
                                                    event.title
                                                )
                                            ),
                                            
                                            dayTransactions.slice(0, 2).map(transaction => 
                                                React.createElement('div',
                                                    {
                                                        key: transaction.id,
                                                        className: `calendar-event-item ${transaction.type === 'income' ? 'bg-green-500' : 'bg-red-500'}`,
                                                        title: transaction.description
                                                    },
                                                    transaction.type === 'income' ? '+' : '-', transaction.amount, ' ₽'
                                                )
                                            ),
                                            
                                            (events.length > 2 || dayTransactions.length > 2) && React.createElement('div', { className: 'text-xs text-gray-700 font-medium' },
                                                '+', (events.length - 2) + (dayTransactions.length - 2), ' еще'
                                            )
                                        )
                                    );
                                })
                            )
                        ),

                        // Transactions History with Categories
                        React.createElement('div', { className: 'card' },
                            React.createElement('div', { className: 'flex justify-between items-center mb-4' },
                                React.createElement('h2', { className: 'text-lg font-semibold' }, 
                                    selectedDate ? `Операции за ${selectedDate.toLocaleDateString('ru-RU')}` : 'История операций'
                                ),
                                React.createElement('div', { className: 'flex items-center space-x-2' },
                                    React.createElement('button',
                                        {
                                            onClick: () => setShowAllTime(!showAllTime),
                                            className: `text-sm px-3 py-1 rounded ${showAllTime ? 'bg-purple-600 text-white' : 'bg-gray-200 hover:bg-gray-300'}`
                                        },
                                        showAllTime ? 'За текущий месяц' : 'За всё время'
                                    ),
                                    selectedDate && React.createElement('button',
                                        {
                                            onClick: () => {
                                                setSelectedDate(null);
                                                setShowAllTime(false);
                                            },
                                            className: 'text-sm bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded'
                                        },
                                        'Показать все'
                                    ),
                                    React.createElement('input',
                                        {
                                            type: 'text',
                                            placeholder: 'Поиск...',
                                            value: searchTerm,
                                            onChange: (e) => setSearchTerm(e.target.value),
                                            className: 'px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    )
                                )
                            ),
                            
                            // Categories filter
                            React.createElement('div', { className: 'categories-container mb-4' },
                                React.createElement('div', 
                                    {
                                        className: `category-item ${selectedCategory === 'all' ? 'active' : ''}`,
                                        onClick: () => setSelectedCategory('all')
                                    },
                                    'Все категории'
                                ),
                                dateCategories.map(category => 
                                    React.createElement('div', 
                                        {
                                            key: category,
                                            className: `category-item ${selectedCategory === category ? 'active' : ''}`,
                                            onClick: () => setSelectedCategory(category)
                                        },
                                        category
                                    )
                                )
                            ),
                            
                            React.createElement('div', { className: 'overflow-x-auto' },
                                React.createElement('table', { className: 'w-full' },
                                    React.createElement('thead', null,
                                        React.createElement('tr', { className: 'border-b border-gray-200' },
                                            React.createElement('th', { className: 'table-header' }, 'Дата'),
                                            React.createElement('th', { className: 'table-header' }, 'Описание'),
                                            React.createElement('th', { className: 'table-header' }, 'Категория'),
                                            React.createElement('th', { className: 'table-header' }, 'Сумма'),
                                            React.createElement('th', { className: 'table-header' }, 'Баланс после'),
                                            React.createElement('th', { className: 'table-header' }, 'Действия')
                                        )
                                    ),
                                    React.createElement('tbody', null,
                                        filteredTransactions.slice().reverse().map(transaction => 
                                            React.createElement('tr', { key: transaction.id, className: 'border-b border-gray-100 hover:bg-gray-50' },
                                                React.createElement('td', { className: 'table-cell' }, new Date(transaction.date).toLocaleDateString('ru-RU')),
                                                React.createElement('td', { className: 'table-cell' }, transaction.description),
                                                React.createElement('td', { className: 'table-cell' },
                                                    React.createElement('span', { className: 'px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs' },
                                                        transaction.category
                                                    )
                                                ),
                                                React.createElement('td', { className: `table-cell font-semibold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}` },
                                                    transaction.type === 'income' ? '+' : '-', transaction.amount.toLocaleString('ru-RU'), ' ₽'
                                                ),
                                                React.createElement('td', { className: `table-cell font-semibold ${transaction.balanceAfter >= 0 ? 'text-green-600' : 'text-red-600'}` },
                                                    transaction.balanceAfter.toLocaleString('ru-RU'), ' ₽'
                                                ),
                                                React.createElement('td', { className: 'table-cell' },
                                                    React.createElement('button',
                                                        {
                                                            onClick: () => {
                                                                setTransactions(transactions.filter(t => t.id !== transaction.id));
                                                            },
                                                            className: 'text-red-500 hover:text-red-700'
                                                        },
                                                        React.createElement('i', { className: 'fas fa-trash' })
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        ),

                        // Settings (moved to the bottom)
                        renderSettings()
                    ),

                    // Shopping List Tab
                    activeTab === 'shopping' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h2', { className: 'text-lg font-semibold mb-4' }, 'Список покупок'),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-4 gap-3 mb-4' },
                                React.createElement('input',
                                    {
                                        type: 'text',
                                        placeholder: 'Название товара',
                                        value: newItem.name,
                                        onChange: (e) => setNewItem({...newItem, name: e.target.value}),
                                        className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                    }
                                ),
                                
                                React.createElement('input',
                                    {
                                        type: 'number',
                                        placeholder: 'Количество',
                                        value: newItem.quantity,
                                        onChange: (e) => setNewItem({...newItem, quantity: parseInt(e.target.value) || 1}),
                                        className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                    }
                                ),
                                
                                React.createElement('select',
                                    {
                                        value: newItem.unit,
                                        onChange: (e) => setNewItem({...newItem, unit: e.target.value}),
                                        className: 'px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                    },
                                    React.createElement('option', { value: 'штука' }, 'штука'),
                                    React.createElement('option', { value: 'литр' }, 'литр'),
                                    React.createElement('option', { value: 'грамм' }, 'грамм'),
                                    React.createElement('option', { value: 'килограмм' }, 'килограмм'),
                                    React.createElement('option', { value: 'метр' }, 'метр'),
                                    React.createElement('option', { value: 'упаковка' }, 'упаковка')
                                ),
                                
                                React.createElement('button',
                                    {
                                        onClick: addShoppingItem,
                                        className: 'btn-primary flex items-center justify-center'
                                    },
                                    React.createElement('i', { className: 'fas fa-plus mr-2' }),
                                    'Добавить'
                                )
                            ),
                            
                            React.createElement('div', { className: 'space-y-2' },
                                shoppingList.map(item => 
                                    React.createElement('div', { key: item.id, className: 'flex items-center justify-between p-3 border border-gray-200 rounded hover:bg-gray-50' },
                                        React.createElement('div', { className: 'flex items-center space-x-3' },
                                            React.createElement('div',
                                                {
                                                    className: `w-5 h-5 rounded border flex items-center justify-center cursor-pointer ${item.completed ? 'bg-green-500 border-green-500' : 'border-gray-300'}`,
                                                    onClick: () => toggleShoppingItem(item.id)
                                                },
                                                item.completed && React.createElement('i', { className: 'fas fa-check text-white text-xs' })
                                            ),
                                            React.createElement('div', null,
                                                React.createElement('span', { className: `${item.completed ? 'line-through text-gray-500' : 'text-gray-800'}` },
                                                    item.item
                                                ),
                                                React.createElement('span', { className: 'text-sm text-gray-600 ml-2' },
                                                    '× ', item.quantity, ' ', item.unit
                                                )
                                            )
                                        ),
                                        React.createElement('button',
                                            {
                                                onClick: () => deleteShoppingItem(item.id),
                                                className: 'text-red-500 hover:text-red-700'
                                            },
                                            React.createElement('i', { className: 'fas fa-trash' })
                                        )
                                    )
                                )
                            ),
                            
                            React.createElement('div', { className: 'flex justify-end mt-4' },
                                React.createElement('button',
                                    {
                                        onClick: () => alert('Список отправлен в Telegram!'),
                                        className: 'bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded transition-colors flex items-center'
                                    },
                                    React.createElement('i', { className: 'fab fa-telegram mr-2' }),
                                    'Отправить в Telegram'
                                )
                            )
                        )
                    ),

                    // Planner Tab
                    activeTab === 'planner' && React.createElement('div', { className: 'space-y-6' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('div', { className: 'flex justify-between items-center mb-4' },
                                React.createElement('h2', { className: 'text-lg font-semibold' }, 'Планировщик событий'),
                                React.createElement('div', { className: 'flex space-x-2' },
                                    React.createElement('button',
                                        {
                                            onClick: () => navigateCalendar(-1),
                                            className: 'p-2 rounded hover:bg-gray-100'
                                        },
                                        React.createElement('i', { className: 'fas fa-chevron-left' })
                                    ),
                                    React.createElement('button',
                                        {
                                            onClick: () => {
                                                const today = new Date();
                                                setCurrentDate(today);
                                            },
                                            className: 'px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700'
                                        },
                                        'Сегодня'
                                    ),
                                    React.createElement('button',
                                        {
                                            onClick: () => navigateCalendar(1),
                                            className: 'p-2 rounded hover:bg-gray-100'
                                        },
                                        React.createElement('i', { className: 'fas fa-chevron-right' })
                                    )
                                )
                            ),
                            
                            React.createElement('div', { className: 'calendar-navigation mb-4' },
                                React.createElement('h2', { className: 'calendar-title text-center' }, title)
                            ),
                            
                            React.createElement('div', { className: 'calendar-grid' },
                                ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'].map(day => 
                                    React.createElement('div', { key: day, className: 'calendar-header-cell' }, day)
                                ),
                                
                                days.map((day, index) => {
                                    const isCurrentMonth = day.getMonth() === currentDate.getMonth();
                                    const isSelected = selectedDate && day.toDateString() === selectedDate.toDateString();
                                    const events = getEventsForDate(day);
                                    const hasEvents = events.length > 0;
                                    
                                    return React.createElement('div',
                                        {
                                            key: index,
                                            className: `calendar-day-cell ${isCurrentMonth ? '' : 'other-month'} ${isSelected ? 'selected-day' : ''} ${hasEvents ? 'cursor-pointer' : ''}`,
                                            onClick: () => hasEvents && handleDayClick(day)
                                        },
                                        React.createElement('div', { className: 'calendar-day-number' },
                                            day.getDate()
                                        ),
                                        
                                        React.createElement('div', { className: 'calendar-events-container' },
                                            events.slice(0, 3).map(event => 
                                                React.createElement('div',
                                                    {
                                                        key: event.id,
                                                        className: `calendar-event-item ${event.color}`,
                                                        title: event.title
                                                    },
                                                    event.title
                                                )
                                            ),
                                            
                                            events.length > 3 && React.createElement('div', { className: 'text-xs text-gray-700 font-medium' },
                                                '+', events.length - 3, ' еще'
                                            )
                                        )
                                    );
                                })
                            )
                        ),

                        React.createElement('div', { className: 'card' },
                            React.createElement('h2', { className: 'text-lg font-semibold mb-4' }, 'Добавить событие'),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                React.createElement('div', { className: 'space-y-3' },
                                    React.createElement('input',
                                        {
                                            type: 'text',
                                            placeholder: 'Название события',
                                            value: newEvent.title,
                                            onChange: (e) => setNewEvent({...newEvent, title: e.target.value}),
                                            className: 'w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    ),
                                    
                                    React.createElement('input',
                                        {
                                            type: 'date',
                                            value: newEvent.date,
                                            onChange: (e) => setNewEvent({...newEvent, date: e.target.value}),
                                            className: 'w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-purple-500 focus:border-transparent'
                                        }
                                    )
                                ),
                                
                                React.createElement('div', { className: 'space-y-3' },
                                    React.createElement('div', { className: 'color-picker' },
                                        colorOptions.map(color => 
                                            React.createElement('div',
                                                {
                                                    key: color,
                                                    className: `color-option ${color} ${newEvent.color === color ? 'selected' : ''}`,
                                                    onClick: () => setNewEvent({...newEvent, color: color}),
                                                    title: color.replace('bg-', '').replace('-500', '')
                                                }
                                            )
                                        )
                                    ),
                                    
                                    React.createElement('button',
                                        {
                                            onClick: addCalendarEvent,
                                            className: 'w-full btn-primary flex items-center justify-center'
                                        },
                                        React.createElement('i', { className: 'fas fa-plus mr-2' }),
                                        'Добавить событие'
                                    )
                                )
                            )
                        ),

                        React.createElement('div', { className: 'card' },
                            React.createElement('div', { className: 'flex justify-between items-center mb-4' },
                                React.createElement('h2', { className: 'text-lg font-semibold' },
                                    selectedDate ? `События за ${selectedDate.toLocaleDateString('ru-RU')}` : 'Все события'
                                ),
                                selectedDate && React.createElement('button',
                                    {
                                        onClick: () => setSelectedDate(null),
                                        className: 'text-sm bg-gray-200 hover:bg-gray-300 px-3 py-1 rounded'
                                    },
                                    'Показать все события'
                                )
                            ),
                            
                            React.createElement('div', { className: 'space-y-3' },
                                calendarEvents
                                    .filter(event => !selectedDate || new Date(event.date).toDateString() === selectedDate.toDateString())
                                    .map(event => 
                                        React.createElement('div', { key: event.id, className: 'flex items-start space-x-3 p-3 border border-gray-200 rounded hover:bg-gray-50' },
                                            React.createElement('div', { className: `w-3 h-3 rounded-full mt-1 ${event.color}` }),
                                            React.createElement('div', { className: 'flex-1' },
                                                React.createElement('div', { className: 'font-medium' }, event.title),
                                                React.createElement('div', { className: 'text-sm text-gray-600' },
                                                    new Date(event.date).toLocaleDateString('ru-RU')
                                                )
                                            ),
                                            React.createElement('button',
                                                {
                                                    onClick: () => deleteCalendarEvent(event.id),
                                                    className: 'text-red-500 hover:text-red-700'
                                                },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    )
                            )
                        )
                    )
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(FamilyBudgetApp));
    </script>
</body>
</html>